from sympy import *


Dm = Matrix([[-1,1,0,0,0,0,0], \
			 [-1,1,0,0,0,0,0], \
			 [-1/5,-3/5,4/5,0,0,0,0], \
			 [0,0,-1,1,0,0,0], \
			 [0,0,0,-1,1,0,0], \
			 [0,0,0,0,-4/5,3/5,1/5], \
			 [0,0,0,0,0,-1,1], \
			 [0,0,0,0,0,-1,1]
		])

Dp = Matrix([[-1,1/2,1/2,0,0,0,0,0], \
			 [-1/2,-1/4,3/4,0,0,0,0,0], \
			 [0,0,-1,1,0,0,0,0], \
			 [0,0,0,-1,1,0,0,0], \
			 [0,0,0,0,-1,1,0,0], \
			 [0,0,0,0,0,-3/4,1/4,1/2], \
			 [0,0,0,0,0,-1/2,-1/2,1]
		])

Hp = diag(1/2,1,1,1,1,1,1/2)
Hm = diag(1/2,1/4,5/4,1,1,5/4,1/4,1/2)

#Ap=(Hp**-1)*Dp*Dm
#Am=(Hm**-1)*Dm*Dp

#Ap=Dp*Dm
#Am=Dm*Dp


Ap=(Hp**-1)*Transpose(Dm)*Dm
Am=(Hm**-1)*Transpose(Dp)*Dp

a, b, c, d, e, gamma, delta =symbols('a b c d e gamma delta')

B = Matrix([[-1,0,0,0,0,0,0], \
			 [0,0,0,0,0,0,0], \
			 [0,0,0,0,0,0,0], \
			 [0,0,0,0,0,0,0], \
			 [0,0,0,0,0,0,0], \
			 [0,0,0,0,0,0,1], \
		])

#Dp = Matrix([[-2,2,0,0,0,0,0], \
#			 [0,-1,1,0,0,0,0], \
#			 [0,0,-1,1,0,0,0], \
#			 [0,0,0,-1,1,0,0], \
#			 [0,0,0,0,-1,1,0], \
#			 [0,0,0,0,0,-2,2]
#		])

#gamma = 1.25

a1=2.0*(gamma-1.0)
a2 = 2.0-3.0*gamma

b1=2.0*(delta-1.0)
b2 = 2.0-3.0*delta

Dp = Matrix([[b1,b2,delta,   0,0,0,0], \
			 [a1,a2,gamma,  0,0,0,0], \
			 [0.0 ,0.0  ,-1.0,1.0,0,0,0], \
			 [0.0 ,0.0  ,0.0,-1.0,1.0,0,0], \
			 [0,0,0,0,-gamma,-a2,-a1], \
			 [0,0,0,0,-delta,-b2,-b1]
		])

#Dp = Matrix([[-2.0,2.0  ,0.0,   0,0,0,0], \
#			 [a1,a2,gamma,  0,0,0,0], \
#			 [0.0 ,0.0  ,-1.0,1.0,0,0,0], \
#			 [0.0 ,0.0  ,0.0,-1.0,1.0,0,0], \
#			 [0,0,0,0,-gamma,-a2,-a1], \
#			 [0,0,0,0,0.0,-2.0,2.0]
#		])
		
Pp = diag(a, b, 1, 1, b, a)
Pm = diag(d, e, 1, 1, 1, e, d)

Qp = Pp * Dp
Qm=(B-Qp).T
Dm = (Pm**-1) * Qm

#Pp = diag(0.25, 0.25, 1, 1, 0.25, 0.25)
#Pm = diag(0.5, 1.5, 1, 1.5, 0.5)

#Dm2 = Matrix([[-1,1,0,0,0,0], \
#			 [-1/3,-1/3,2/3,0,0,0], \
#			 [0,0,-1,1,0,0], \
#			 [0,0,0,-2/3,1/3,1/3], \
#			 [0,0,0,0,-1,1] \
#		])

